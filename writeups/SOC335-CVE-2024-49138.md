
## Initial findings

![[SOC335 - CVE-2024-49138 Exploitation Detected.png]]

**Event Time:** Jan, 22,2025, 02:37 AM
**Hostname :** Victor
**Ip Address :** 1721617207
**Process Name :** svohost.exe
**Process Path :** "C\temp\service_installer\svohost.exe"
**Parent Process :** C\Windows\System32\WINDOWSPOWERSHELL\V1.0\powershell.exe
**Command Line :** C\Windows\system32\conhost.exe Oxfffffff -ForceV1
**File Hash :** b432dcf4a0f0b601b1d79848467137a5e25cabSa0b7b1224be9d3b6540122db9
**Trigger Reason :** Unusual or suspicious patterns of behavior linked to the hash have been identified, indicating potential exploitation of CVE-2024-49138.

## Investigation

The first thing that stands out is process name **svohost.exe**. It closely resembles the legitimate **svchost.exe** process, which is a critical system process in Windows.

Another intersting thing is the use of `conhost.exe` with `0xffffffff -ForceV1`. It is not normal for standard Windows operations.

The use of PowerShell as a parent process is also a red flag, since it is often used in scripting attacks, information gathering, and C2 activities.

### Sample analysis

#### Virus Total

![[SOC335 - CVE-2024-49138 Exploitation Detected-1.png]]

#### Hybrid analysis

![[SOC335 - CVE-2024-49138 Exploitation Detected-2.png]]

Sample scored 49/72 on VirusTotal and 55/100 on HybridAnalysis. Examining the results, we can assume it is a trojan. Hybrid Analysis specified that sample contains a known VM detection trick and ability to delay its' execution, a common tactic used by attackers to avoid detection.

## Starting a playbook

![[SOC335 - CVE-2024-49138 Exploitation Detected-3.png]]

### Log Management & Endpoint Security Analysis

![[SOC335 - CVE-2024-49138 Exploitation Detected-4.png]]

During log and Endpoint Security analysis, we discovered multiple login attempts, one of which succeeded. The attacker successfully gained access using the hostname **Victor**.

![[SOC335 - CVE-2024-49138 Exploitation Detected-5.png]]

![[SOC335 - CVE-2024-49138 Exploitation Detected-6.png]]

Upon further investigation into the Endpoint Security logs for the **Victor** system, we found that **svohost.exe** is still running under **PID 1376**. This indicates that the attacker had successfully compromised the system and initiated the **svohost.exe** process to maintain persistence, continuing to operate under the name of a legitimate service.

We also discovered the command used to deliver **svohost.exe**:

![[SOC335 - CVE-2024-49138 Exploitation Detected-8.png]]

The malware has not been contained in quarantine. 
### C2 Request

![[SOC335 - CVE-2024-49138 Exploitation Detected-9.png]]

Yes, the **C2** server has been accessed, and the attacker successfully established a connection to the target machine. This allowed them to execute commands remotely and potentially gain control over the system.

![[SOC335 - CVE-2024-49138 Exploitation Detected-5.png]]

### Containment

![[SOC335 - CVE-2024-49138 Exploitation Detected-10.png]]

We must contain user machine to prevent further expoitation.

![[SOC335 - CVE-2024-49138 Exploitation Detected-7.png]]

### Artifacts

![[SOC335 - CVE-2024-49138 Exploitation Detected-11.png]]

### Conclusion

We can confirm the exploitation of CVE-2024-49138 and malicious nature of the executable. 

The detection of a **C2** server connection and the execution of `svohost.exe`confirms a system compromise. The attacker utilized **PowerShell** to download and execute a malicious payload, which led to the immediate containment of the affected machine to prevent further impact.

Upon further investigation into the Endpoint Security logs for the **Victor** system, we found that the malicious process, **svohost.exe**, was still actively running under **PID 7640**. This indicates that the attacker had successfully compromised the system and initiated the **svohost.exe** process to maintain persistence, continuing to operate under the guise of a legitimate service. The presence of this process suggests that the attacker may be executing further malicious actions, potentially with elevated privileges
